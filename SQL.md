#### 数据表结构
```sql
SET CHARACTER  SET utf8;
DROP DATABASE IF EXISTS SQLearn;
CREATE DATABASE SQLearn;
USE SQLearn;

CREATE TABLE student(学号 VARCHAR(32) PRIMARY KEY,姓名 VARCHAR(32),出生日期 date,性别 VARCHAR(32)  );
CREATE TABLE course(课程号 VARCHAR(32),课程名称 VARCHAR(32),教师号 VARCHAR(32)  );
CREATE TABLE score(学号 VARCHAR(32),课程号 VARCHAR(32),成绩 FLOAT  );
CREATE TABLE teacher(教师号 VARCHAR(32) PRIMARY KEY,教师名称 VARCHAR(32) );

insert into student(学号,姓名,出生日期,性别) values('0001' , '猴子' , '1989-01-01' , '男'),('0002' , '猴子' , '1990-12-21' , '女'),('0003' , '马云' , '1991-12-21' , '男'),('0004' , '王思聪' , '1990-05-20' , '男');
insert into score(学号,课程号,成绩) values('0001' , '0001' , 80),('0001' , '0002' , 90),('0001' , '0003' , 99),('0002' , '0002' , 60),('0002' , '0003' , 80),('0003' , '0001' , 80),('0003' , '0002' , 80),('0003' , '0003' , 80);
insert into course(课程号,课程名称,教师号) values('0001' , '语文' , '0002'),('0002' , '数学' , '0001'),('0003' , '英语' , '0003');
insert into teacher(教师号,教师名称) values('0001', '孟扎扎'),('0002' , '马化腾'),('0003' , null),('0004' , '');

```

#### GROUP BY 分组示例

```sql
-- 单表查询一般思路
select 查询结果 
from 从哪张表中查找数据 
where 查询条件 
group by 分组 
having 对分组结果指定条件 
order by 对查询结果排序;

--查询平均成绩大于60分学生的学号和平均成绩
-- 按照学号进行group by分组
mysql root@(none):SQLearn> select 学号, avg(成绩) AS 平均成绩 from score group by 学号 having avg(成绩) > 60;                                                                                                    
+------+---------------+
| 学号 | 平均成绩      |
+------+---------------+
| 0001 | 89.6666666667 |
| 0002 | 70.0          |
| 0003 | 80.0          |
+------+---------------+

-- 查询至少选修两门课程的学生学号
mysql root@(none):SQLearn> select 学号 from score group by 学号 having count(1) >= 2;                                                                                                                            
+------+
| 学号 |
+------+
| 0001 |
| 0002 |
| 0003 |
+------+
-- 查询同名同姓学生名单并统计同名人数
mysql root@(none):SQLearn> select 姓名, count(1) as 数量 from student group by 姓名 having count(1) > 1;                                                                                                         
+------+------+
| 姓名 | 数量 |
+------+------+
| 猴子 | 2    |
+------+------+
-- 查询每门课程的平均成绩，结果按平均成绩升序排序，平均成绩相同时，按课程号降序排列
-- 按照课程号进行分组 
-- order by排序后面可以跟多个字段
mysql root@(none):SQLearn> SELECT 课程号, avg(成绩) FROM score group by 课程号 order by avg(成绩) asc, 课程号 desc;                                                                                              
+--------+---------------+
| 课程号 | avg(成绩)     |
+--------+---------------+
| 0002   | 76.6666666667 |
| 0001   | 80.0          |
| 0003   | 86.3333333333 |
+--------+---------------+

-- 查询所有课程成绩小于60分学生的学号、姓名
mysql root@(none):SQLearn> select * from student where  学号 not  in (select 学号 from score where 成绩 > 60 and student.学号=score.学号);                                                                       
+------+--------+------------+------+
| 学号 | 姓名   | 出生日期   | 性别 |
+------+--------+------------+------+
| 0004 | 王思聪 | 1990-05-20 | 男   |
+------+--------+------------+------+

--查询没有学全所有课的学生的学号、姓名
/*
查找出学号，条件：没有学全所有课，也就是该学生选修的课程数 < 总的课程数
【考察知识点】in，子查询
*/
mysql root@(none):SQLearn> select 学号, 姓名 from student where 学号 in (select 学号 from score group by 学号 having count(课程号) < (select count(1) from course));                                             
+------+------+
| 学号 | 姓名 |
+------+------+
| 0002 | 猴子 |
+------+------+
-- 1990年出生的学生名单
mysql root@(none):SQLearn> select * from student where year(出生日期)=1990;                                                                                                                                      
+------+--------+------------+------+
| 学号 | 姓名   | 出生日期   | 性别 |
+------+--------+------------+------+
| 0002 | 猴子   | 1990-12-21 | 女   |
| 0004 | 王思聪 | 1990-05-20 | 男   |
+------+--------+------------+------+
```

#### 多表查询

```sql
-- 查询所有学生的学号、姓名、选课数、总成绩
mysql root@(none):SQLearn> select student.学号, student.姓名, count(score.课程号) as 课程数量, sum(成绩) as 总分 from student right join score on student.学号=score.学号 group by student.学号;                 
+------+------+----------+-------+
| 学号 | 姓名 | 课程数量 | 总分  |
+------+------+----------+-------+
| 0001 | 猴子 | 3        | 269.0 |
| 0002 | 猴子 | 2        | 140.0 |
| 0003 | 马云 | 3        | 215.0 |
+------+------+----------+-------+
-- 查询学生的选课情况：学号，姓名，课程号，课程名称
-- 多个表连接查询
mysql root@(none):SQLearn> select stu.学号, stu.姓名, cour.课程号, cour.课程名称 from student stu right join score sco on sco.学号 = stu.学号 right join course as cour on sco.课程号 = cour.课程号;             
+------+------+--------+----------+
| 学号 | 姓名 | 课程号 | 课程名称 |
+------+------+--------+----------+
| 0001 | 猴子 | 0001   | 语文     |
| 0003 | 马云 | 0001   | 语文     |
| 0001 | 猴子 | 0002   | 数学     |
| 0002 | 猴子 | 0002   | 数学     |
| 0003 | 马云 | 0002   | 数学     |
| 0001 | 猴子 | 0003   | 英语     |
| 0002 | 猴子 | 0003   | 英语     |
| 0003 | 马云 | 0003   | 英语     |
+------+------+--------+----------+
-- 查询不同老师所教不同课程平均分从高到低显示
mysql root@(none):SQLearn> select t.教师名称, avg(s.成绩) as 平均成绩  from teacher t right join course c on t.教师号 = c.教师号 right join score s on s.课程号=c.课程号 group by t.教师号 order by avg(s.成绩) asc;                                                                                                                
+----------+---------------+
| 教师名称 | 平均成绩      |
+----------+---------------+
| 孟扎扎   | 76.6666666667 |
| <null>   | 78.0          |
| 马化腾   | 80.0          |
+----------+---------------+

```

#### 左右连接区别

```sql
mysql root@(none):SQLearn> select * from course;                                                                                                                                                                 
+--------+----------+--------+
| 课程号 | 课程名称 | 教师号 |
+--------+----------+--------+
| 0001   | 语文     | 0002   |
| 0002   | 数学     | 0001   |
| 0003   | 英语     | 0003   |
| 0004   | 物理     | 0010   |
| 0005   | 化学     | 0002   |
+--------+----------+--------+
mysql root@(none):SQLearn> select * from teacher;                                                                                                                                                                
+--------+----------+
| 教师号 | 教师名称 |
+--------+----------+
| 0001   | 孟扎扎   |
| 0002   | 马化腾   |
| 0003   | <null>   |
| 0004   |          |
+--------+----------+
-- 左连接，以左表数据为准，如果数据在左表存在，右边不存在，则默认未null
mysql root@(none):SQLearn> select * from course left join teacher on teacher.教师号 = course.教师号 order by course.教师号;                                                                                      
+--------+----------+--------+--------+----------+
| 课程号 | 课程名称 | 教师号 | 教师号 | 教师名称 |
+--------+----------+--------+--------+----------+
| 0002   | 数学     | 0001   | 0001   | 孟扎扎   |
| 0001   | 语文     | 0002   | 0002   | 马化腾   |
| 0005   | 化学     | 0002   | 0002   | 马化腾   |
| 0003   | 英语     | 0003   | 0003   | <null>   |
| 0004   | 物理     | 0010   | <null> | <null>   |
+--------+----------+--------+--------+----------+

-- 分析：教师号0010在左表course存在，右表teacher中没有，则teacher中不存在的字段为null

-- 右连接，以右表数据为准，如果数据在右表存在，左边不存在，则默认未null
mysql root@(none):SQLearn> select * from course right join teacher on teacher.教师号 = course.教师号 order by course.教师号;                                                                                     
+--------+----------+--------+--------+----------+
| 课程号 | 课程名称 | 教师号 | 教师号 | 教师名称 |
+--------+----------+--------+--------+----------+
| <null> | <null>   | <null> | 0004   |          |
| 0002   | 数学     | 0001   | 0001   | 孟扎扎   |
| 0001   | 语文     | 0002   | 0002   | 马化腾   |
| 0005   | 化学     | 0002   | 0002   | 马化腾   |
| 0003   | 英语     | 0003   | 0003   | <null>   |
+--------+----------+--------+--------+----------+
--分析：教师号0004在右表teacher存在，左表course中没有，则course中不存在的字段为null
```

